<!DOCTYPE html>
<html lang="fr" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Macros VBA Malveillantes | ForensicLab</title>
    
    <!-- Polices -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Notre thème personnalisé (intégré) -->
    <style>
        :root {
            /* Couleurs de base en mode clair */
            --primary: #6a3de8; /* Violet principal */
            --primary-rgb: 106, 61, 232;
            --primary-hover: #5a2dd8;
            --primary-light: #e9e3fa;
            --primary-dark: #4a1db8;
            --secondary: #6c757d;
            --secondary-rgb: 108, 117, 125;
            --success: #38a169;
            --info: #3498db;
            --warning: #f39c12;
            --danger: #dc2626;
            --light: #f1f5f9;
            --dark: #1e293b;
            --body-bg: #f1f5f9;
            --body-color: #384251;
            --body-color-rgb: 56, 66, 81;
            --heading-color: #1e293b;
            --border-color: #cbd5e1;
            --card-bg: #ffffff;
            --sidebar-bg: #ffffff;
            --sidebar-hover: #e9e3fa;
            --sidebar-active: #6a3de8;
        }
        
        [data-theme="dark"] {
            /* Couleurs en mode sombre */
            --primary: #8a63f7; /* Violet plus clair pour le mode sombre */
            --primary-rgb: 138, 99, 247;
            --primary-hover: #9a73ff;
            --primary-light: #2d2145;
            --primary-dark: #b59aff;
            --body-bg: #0f172a;
            --body-color: #9cb2d1;
            --body-color-rgb: 156, 178, 209;
            --heading-color: #f1f5f9;
            --border-color: #334155;
            --card-bg: #1e293b;
            --sidebar-bg: #1e293b;
            --sidebar-hover: #2d2145;
            --sidebar-active: #8a63f7;
        }
        
        body {
            background-color: var(--body-bg);
            color: var(--body-color);
            font-family: 'Inter', sans-serif;
        }
        
        /* Styles pour la navbar */
        .navbar {
            background-color: var(--card-bg);
            border-bottom: 1px solid var(--border-color);
        }
        
        .navbar-brand {
            color: var(--primary);
            font-weight: 600;
        }
        
        .nav-link {
            color: var(--body-color);
            font-weight: 500;
        }
        
        .nav-link.active, .nav-link:hover {
            color: var(--primary);
        }
        
        /* Styles pour les badges de difficulté */
        .badge-beginner {
            background-color: #4ade80;
            color: #064e3b;
        }
        
        .badge-intermediate {
            background-color: #facc15;
            color: #713f12;
        }
        
        .badge-advanced {
            background-color: #f97316;
            color: #7c2d12;
        }
        
        .badge-expert {
            background-color: #ef4444;
            color: #7f1d1d;
        }
        
        /* Styles pour la progression */
        .progress {
            height: 10px;
            background-color: var(--border-color);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .progress-bar {
            background-color: var(--primary);
            border-radius: 10px;
        }
        
        /* Styles pour les labs */
        .lab-card {
            border-left: 4px solid var(--primary);
            transition: transform 0.2s;
        }
        
        .lab-card:hover {
            transform: translateX(5px);
        }
        
        .lab-card.completed {
            border-left-color: #38a169;
        }
        
        .lab-card.in-progress {
            border-left-color: #f39c12;
        }
        
        /* Styles pour les sections du cours */
        .course-section {
            border-radius: 8px;
            border: 1px solid var(--border-color);
            margin-bottom: 20px;
            overflow: hidden;
        }
        
        .course-section-header {
            background-color: var(--card-bg);
            padding: 15px 20px;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
        }
        
        .course-section-content {
            padding: 20px;
            background-color: var(--body-bg);
        }
        
        /* Barre latérale de navigation du cours */
        .course-sidebar {
            position: sticky;
            top: 20px;
        }
        
        .course-nav-item {
            padding: 10px 15px;
            border-radius: 6px;
            margin-bottom: 5px;
            color: var(--body-color);
            display: block;
            text-decoration: none;
            transition: all 0.2s;
        }
        
        .course-nav-item:hover, .course-nav-item.active {
            background-color: var(--primary-light);
            color: var(--primary);
        }
        
        /* Styles pour les détails du cours */
        .course-detail {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            color: var(--body-color);
        }
        
        .course-detail i {
            margin-right: 8px;
            color: var(--primary);
            width: 20px;
            text-align: center;
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg sticky-top">
        <div class="container">
            <a class="navbar-brand" href="../index.html">
                <i class="fas fa-shield-alt me-2"></i>ForensicLab
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="../index.html">Accueil</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="../index.html#courses">Cours</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../index.html#progress">Progression</a>
                    </li>
                </ul>
                <div class="d-flex align-items-center">
                    <button id="theme-toggle" class="btn btn-outline-primary me-2">
                        <i class="fas fa-moon"></i>
                    </button>
                    <a href="#" class="btn btn-primary">
                        <i class="fas fa-user me-1"></i> Mon Compte
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- En-tête du cours -->
    <section class="py-5 bg-primary text-white">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-8">
                    <div class="d-flex align-items-center mb-3">
                        <div class="bg-white rounded-circle p-3 me-3">
                            <i class="fas fa-file-word fa-2x text-primary"></i>
                        </div>
                        <h1 class="fw-bold mb-0">Macros VBA Malveillantes</h1>
                    </div>
                    <div class="d-flex flex-wrap gap-3 mb-4">
                        <div class="d-flex align-items-center">
                            <i class="fas fa-clock me-2"></i>
                            <span>10 heures</span>
                        </div>
                        <div class="d-flex align-items-center">
                            <i class="fas fa-flask me-2"></i>
                            <span>5 labs pratiques</span>
                        </div>
                        <div class="d-flex align-items-center">
                            <i class="fas fa-signal me-2"></i>
                            <span>Niveau: <span class="badge bg-danger ms-1">Avancé</span></span>
                        </div>
                    </div>
                    <p class="lead">Apprenez à détecter et analyser les macros VBA malveillantes dans les documents Office pour comprendre les techniques d'attaque.</p>
                </div>
                <div class="col-lg-4">
                    <div class="card">
                        <div class="card-body p-4">
                            <h5 class="card-title mb-3">Votre progression</h5>
                            <div class="progress mb-3">
                                <div class="progress-bar" role="progressbar" style="width: 30%;" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100"></div>
                            </div>
                            <div class="d-flex justify-content-between text-white mb-4">
                                <span>30% complété</span>
                                <span>1/4 sections</span>
                            </div>
                            <button class="btn btn-light w-100">
                                <i class="fas fa-play-circle me-2"></i>Continuer
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Contenu principal -->
    <section class="py-5">
        <div class="container">
            <div class="row">
                <!-- Barre latérale -->
                <div class="col-lg-3 mb-4 mb-lg-0">
                    <div class="course-sidebar">
                        <div class="card mb-4">
                            <div class="card-body">
                                <h5 class="card-title mb-3">Contenu du cours</h5>
                                <div class="list-group">
                                    <a href="#section1" class="course-nav-item active">
                                        <i class="fas fa-check-circle me-2 text-success"></i>
                                        Introduction aux macros VBA
                                    </a>
                                    <a href="#section2" class="course-nav-item">
                                        <i class="fas fa-circle me-2 text-muted"></i>
                                        Techniques d'obfuscation
                                    </a>
                                    <a href="#section3" class="course-nav-item">
                                        <i class="fas fa-circle me-2 text-muted"></i>
                                        Extraction et déobfuscation
                                    </a>
                                    <a href="#section4" class="course-nav-item">
                                        <i class="fas fa-circle me-2 text-muted"></i>
                                        Analyse dynamique
                                    </a>
                                    <a href="#labs" class="course-nav-item">
                                        <i class="fas fa-flask me-2 text-warning"></i>
                                        Labs pratiques
                                    </a>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title mb-3">Ressources</h5>
                                <div class="list-group">
                                    <a href="#" class="course-nav-item">
                                        <i class="fas fa-file-pdf me-2"></i>
                                        Guide de référence VBA
                                    </a>
                                    <a href="#" class="course-nav-item">
                                        <i class="fas fa-download me-2"></i>
                                        Échantillons de documents
                                    </a>
                                    <a href="#" class="course-nav-item">
                                        <i class="fas fa-external-link-alt me-2"></i>
                                        Documentation des outils
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Contenu principal -->
                <div class="col-lg-9">
                    <!-- Section 1 -->
                    <div id="section1" class="course-section">
                        <div class="course-section-header d-flex justify-content-between align-items-center">
                            <h3 class="mb-0 fs-5">1. Introduction aux macros VBA</h3>
                            <span class="badge bg-success">Complété</span>
                        </div>
                        <div class="course-section-content">
                            <p>Les macros VBA (Visual Basic for Applications) sont des séquences d'instructions qui automatisent des tâches dans les applications Microsoft Office. Bien qu'elles soient conçues pour améliorer la productivité, elles sont souvent détournées à des fins malveillantes.</p>
                            
                            <h5 class="mt-4">Formats de documents Office contenant des macros:</h5>
                            <ul>
                                <li><strong>.docm</strong> - Document Word avec macros</li>
                                <li><strong>.xlsm</strong> - Classeur Excel avec macros</li>
                                <li><strong>.pptm</strong> - Présentation PowerPoint avec macros</li>
                                <li><strong>.doc, .xls, .ppt</strong> - Anciens formats Office (pré-2007) pouvant contenir des macros</li>
                            </ul>
                            
                            <h5 class="mt-4">Structure d'un document Office avec macros:</h5>
                            <p>Les documents Office modernes (OOXML) sont en réalité des archives ZIP contenant plusieurs fichiers XML. Les macros VBA sont stockées dans un flux binaire appelé "VBA Project" à l'intérieur de cette archive.</p>
                            
                            <div class="bg-dark text-light p-3 rounded mt-4">
                                <pre><code># Extraire le contenu d'un document Office
unzip -d extracted_content document.docm

# Structure typique d'un document Word avec macros
extracted_content/
├── [Content_Types].xml
├── _rels/
├── docProps/
├── word/
│   ├── document.xml
│   ├── vbaProject.bin  # Contient le code VBA
│   └── ...
└── ...</code></pre>
                            </div>
                            
                            <h5 class="mt-4">Vecteurs d'attaque courants:</h5>
                            <ul>
                                <li><strong>Phishing</strong> - Documents malveillants envoyés par e-mail</li>
                                <li><strong>Ingénierie sociale</strong> - Inciter l'utilisateur à activer les macros</li>
                                <li><strong>Téléchargements drive-by</strong> - Documents téléchargés depuis des sites web compromis</li>
                                <li><strong>Exploitation de vulnérabilités</strong> - Utilisation de failles dans Office pour exécuter du code sans avertissement</li>
                            </ul>
                            
                            <div class="alert alert-warning mt-4">
                                <i class="fas fa-exclamation-triangle me-2"></i>
                                <strong>Attention:</strong> L'analyse de macros malveillantes doit toujours être effectuée dans un environnement isolé pour éviter une infection accidentelle.
                            </div>
                        </div>
                    </div>
                    
                    <!-- Section 2 -->
                    <div id="section2" class="course-section">
                        <div class="course-section-header d-flex justify-content-between align-items-center">
                            <h3 class="mb-0 fs-5">2. Techniques d'obfuscation</h3>
                            <span class="badge bg-secondary">Non commencé</span>
                        </div>
                        <div class="course-section-content">
                            <p>Cette section sera débloquée une fois que vous aurez terminé les sections précédentes.</p>
                            <button class="btn btn-primary mt-3">
                                <i class="fas fa-lock me-2"></i>Débloquer cette section
                            </button>
                        </div>
                    </div>
                    
                    <!-- Section 3 -->
                    <div id="section3" class="course-section">
                        <div class="course-section-header d-flex justify-content-between align-items-center">
                            <h3 class="mb-0 fs-5">3. Extraction et déobfuscation</h3>
                            <span class="badge bg-secondary">Non commencé</span>
                        </div>
                        <div class="course-section-content">
                            <p>Cette section sera débloquée une fois que vous aurez terminé les sections précédentes.</p>
                            <button class="btn btn-primary mt-3">
                                <i class="fas fa-lock me-2"></i>Débloquer cette section
                            </button>
                        </div>
                    </div>
                    
                    <!-- Section 4 -->
                    <div id="section4" class="course-section">
                        <div class="course-section-header d-flex justify-content-between align-items-center">
                            <h3 class="mb-0 fs-5">4. Analyse dynamique</h3>
                            <span class="badge bg-secondary">Non commencé</span>
                        </div>
                        <div class="course-section-content">
                            <p>Cette section sera débloquée une fois que vous aurez terminé les sections précédentes.</p>
                            <button class="btn btn-primary mt-3">
                                <i class="fas fa-lock me-2"></i>Débloquer cette section
                            </button>
                        </div>
                    </div>
                    
                    <!-- Labs pratiques -->
                    <div id="labs" class="mt-5">
                        <h3 class="mb-4">Labs pratiques</h3>
                        
                        <div class="card lab-card completed mb-3">
                            <div class="card-body p-4">
                                <div class="d-flex justify-content-between align-items-center">
                                    <h5 class="card-title mb-0">Lab 1: Extraction de macros VBA</h5>
                                    <span class="badge bg-success">Complété</span>
                                </div>
                                <p class="card-text mt-2">Apprenez à extraire le code VBA des documents Office en utilisant différents outils.</p>
                                <div class="d-flex justify-content-between align-items-center mt-3">
                                    <div>
                                        <span class="badge bg-light text-dark me-2">45 minutes</span>
                                        <span class="badge bg-light text-dark">Intermédiaire</span>
                                    </div>
                                    <a href="#" class="btn btn-sm btn-outline-primary">Revoir</a>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card lab-card in-progress mb-3">
                            <div class="card-body p-4">
                                <div class="d-flex justify-content-between align-items-center">
                                    <h5 class="card-title mb-0">Lab 2: Analyse de code VBA obfusqué</h5>
                                    <span class="badge bg-warning">En cours</span>
                                </div>
                                <p class="card-text mt-2">Découvrez les techniques courantes d'obfuscation et apprenez à déobfusquer le code VBA malveillant.</p>
                                <div class="d-flex justify-content-between align-items-center mt-3">
                                    <div>
                                        <span class="badge bg-light text-dark me-2">60 minutes</span>
                                        <span class="badge bg-light text-dark">Avancé</span>
                                    </div>
                                    <a href="#" class="btn btn-sm btn-primary">Continuer</a>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card lab-card mb-3">
                            <div class="card-body p-4">
                                <div class="d-flex justify-content-between align-items-center">
                                    <h5 class="card-title mb-0">Lab 3: Analyse statique avec OLEVBA</h5>
                                    <span class="badge bg-secondary">Non commencé</span>
                                </div>
                                <p class="card-text mt-2">Utilisez l'outil OLEVBA pour analyser automatiquement les macros VBA et détecter les indicateurs de compromission.</p>
                                <div class="d-flex justify-content-between align-items-center mt-3">
                                    <div>
                                        <span class="badge bg-light text-dark me-2">60 minutes</span>
                                        <span class="badge bg-light text-dark">Avancé</span>
                                    </div>
                                    <a href="#" class="btn btn-sm btn-outline-secondary">Commencer</a>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card lab-card mb-3">
                            <div class="card-body p-4">
                                <div class="d-flex justify-content-between align-items-center">
                                    <h5 class="card-title mb-0">Lab 4: Analyse dynamique en environnement contrôlé</h5>
                                    <span class="badge bg-secondary">Non commencé</span>
                                </div>
                                <p class="card-text mt-2">Exécutez des macros malveillantes dans un environnement sécurisé et analysez leur comportement.</p>
                                <div class="d-flex justify-content-between align-items-center mt-3">
                                    <div>
                                        <span class="badge bg-light text-dark me-2">90 minutes</span>
                                        <span class="badge bg-light text-dark">Expert</span>
                                    </div>
                                    <a href="#" class="btn btn-sm btn-outline-secondary">Commencer</a>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card lab-card mb-3">
                            <div class="card-body p-4">
                                <div class="d-flex justify-content-between align-items-center">
                                    <h5 class="card-title mb-0">Lab 5: Challenge d'analyse VBA</h5>
                                    <span class="badge bg-secondary">Non commencé</span>
                                </div>
                                <p class="card-text mt-2">Mettez en pratique toutes vos compétences pour analyser un document Office malveillant complexe.</p>
                                <div class="d-flex justify-content-between align-items-center mt-3">
                                    <div>
                                        <span class="badge bg-light text-dark me-2">120 minutes</span>
                                        <span class="badge bg-light text-dark">Expert</span>
                                    </div>
                                    <a href="#" class="btn btn-sm btn-outline-secondary">Commencer</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="py-4 mt-5">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <a class="navbar-brand mb-3 d-inline-block" href="../index.html">
                        <i class="fas fa-shield-alt me-2"></i>ForensicLab
                    </a>
                    <p class="mb-3">Plateforme de formation complète en forensique numérique avec des cours, des labs et des challenges.</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="mb-1">© 2025 ForensicLab. Tous droits réservés.</p>
                    <div>
                        <a href="#" class="text-decoration-none me-3">Politique de confidentialité</a>
                        <a href="#" class="text-decoration-none">Conditions d'utilisation</a>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Script pour le switch de thème -->
    <script>
        // Fonction pour basculer entre les thèmes clair et sombre
        function toggleTheme() {
            const html = document.documentElement;
            const themeToggle = document.getElementById('theme-toggle');
            const currentTheme = html.getAttribute('data-theme');
            
            if (currentTheme === 'dark') {
                html.setAttribute('data-theme', 'light');
                themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
                localStorage.setItem('theme', 'light');
            } else {
                html.setAttribute('data-theme', 'dark');
                themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
                localStorage.setItem('theme', 'dark');
            }
        }
        
        // Initialiser le thème au chargement de la page
        document.addEventListener('DOMContentLoaded', function() {
            const savedTheme = localStorage.getItem('theme');
            const themeToggle = document.getElementById('theme-toggle');
            
            if (savedTheme) {
                document.documentElement.setAttribute('data-theme', savedTheme);
                if (savedTheme === 'light') {
                    themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
                }
            }
            
            // Ajouter l'événement de clic au bouton de bascule de thème
            themeToggle.addEventListener('click', toggleTheme);
        });
    </script>
</body>
</html>
